var TFIDF = require('./tfidf'),
    Vocabulary = require('./Vocabulary'),
    Article = require('./Article');

var vocabulary = Vocabulary();

var article1 = vocabulary.addArticle(Article("Google and Yahoo, two of the world's biggest tech companies, reacted angrily to a report on Wednesday that the National Security Agency has secretly intercepted the main communication links that carry their users' data around the world. Citing documents obtained from former NSA contractor Edward Snowden and interviews with officials, the Washington Post claimed the agency could collect information \"at will\" from among hundreds of millions of user accounts. The documents suggest that the NSA, in partnership with its British counterpart GCHQ, is copying large amounts of data as it flows across fiber-optic cables that carry information between the worldwide data centers of the Silicon Valley giants. The intelligence activities of the NSA outside the US are subject to fewer legal constraints than its domestic actions. The story is likely to put further strain on the already difficult relations between the tech firms and Washington. The internet giants are furious about the damage done to their reputation in the wake of Snowden's revelations. In a statement, Google's chief legal officer, David Drummond, said the company was \"outraged\" by the latest revelations. \"We have long been concerned about the possibility of this kind of snooping, which is why we have continued to extend encryption across more and more Google services and links, especially the links in the slide,\" he said. \"We do not provide any government, including the US government, with access to our systems. We are outraged at the lengths to which the government seems to have gone to intercept data from our private fiber networks, and it underscores the need for urgent reform.\" Yahoo said: \"We have strict controls in place to protect the security of our data centers, and we have not given access to our data centers to the NSA or to any other government agency.\" According to a top-secret document cited by the Post dated 9 January 2013, millions of records a day are sent from Yahoo and Google internal networks to NSA data warehouses at the agency's headquarters in Fort Meade, Maryland. The types of information sent ranged from \"metadata\", indicating who sent or received emails, the subject line and where and when, to content such as text, audio and video. The Post's documents state that in the preceding 30 days, field collectors had processed and sent on 181,280,466 new records. Internet firms go to great lengths to protect their data. But the NSA documents published by the Post appear to boast about their ability to circumvent those protections. In one presentation slide on \"Google Cloud Exploitation,\" published by the Post, an artist has added a smiley face, in apparent celebration of the NSA's victory over Google security systems. The Post said that the interception took place on the cables that connect the internet giants' data centers. The New York Times reported on Wednesday evening that one of the companies that provides such cables for Google was Level 3. It said in a statement provided to the Times: \"We comply with the laws in each country where we operate. In general, governments that seek assistance in law enforcement or security investigations prohibit disclosure of the assistance provided.\" In its report, the Post suggested the intercept project was codenamed Muscular, but the Guardian understands from other documents provided by Snowden that the term instead refers to the system that enables the initial processing of information gathered from NSA or GCHQ cable taps. The data outputted from Muscular is then forwarded to NSA or GCHQ databases, or systems such as the XKeyscore search tool, previously reported by the Guardian. The Post said that by collecting the data overseas, the NSA was able to circumvent the legal restrictions that prevent it from accessing the communications of people who live in the United States, and that it fell instead under an executive order, signed by the president, that authorised foreign intelligence operations. In response, the NSA specifically denied that it used the presidential order to circumvent the restrictions on domestic spying, though the agency said nothing about the rest of the story. The NSA statement said, in full: \"NSA has multiple authorities that it uses to accomplish its mission, which is centered on defending the nation. The Washington Post's assertion that we use Executive Order 12333 collection to get around the limitations imposed by the Foreign Intelligence Surveillance Act and FAA 702 is not true. \"The assertion that we collect vast quantities of US persons' data from this type of collection is also not true. NSA applies attorney general-approved processes to protect the privacy of US persons – minimizing the likelihood of their information in our targeting, collection, processing, exploitation, retention and dissemination. \"NSA is a foreign intelligence agency. And we're focused on discovering and developing intelligence about valid foreign intelligence targets only. \"A GCHQ spokesman said: \"We are aware of the story but we don't have any comment.\" The NSA statement was much more narrowly drawn than the initial response by the agency's director, General Keith Alexander. At a Washington conference on Wednesday as the Post story broke, Alexander issued an immediate denial, but was not specifically asked to address allegations that the NSA intercepted data transiting between the companies' data centers. The latest disclosures may shed new light on a reference in a GCHQ document, first reported in September by the Guardian, the New York Times and ProPublica. As part of its efforts with the NSA to defeat internet encryption, GCHQ, the 2012 document said, was working on developing ways into the major webmail providers, including Google and Yahoo. It added that \"work has predominantly been focused this quarter on Google due to new access opportunities being developed\". Other documents provided to the Guardian by Snowden suggest that GCHQ's work on Muscular, and a related tool called Incensor, is regarded as particularly valuable by the NSA, providing intelligence unavailable from other sources.\"Muscular/Incensor has significantly enhanced the amount of benefit that the NSA derives from our special source access,\" one 2010 GCHQ document notes. It adds that this highlights \"the unique contribution we are now making to NSA, providing insights into some of their highest priority targets\". Relations between the tech companies and the government are already strained over the Snowden revelations. Speaking at a tech conference in September, Facebook co-founder Mark Zuckerberg said the government had done a \"bad job\" of balancing people's privacy. \"Frankly, I think the government blew it,\" he said. Google will have its first turn before a legislative panel to confront surveillance questions next month. Senators Al Franken and Dean Heller, who are backing a bill to compel the government to provide more transparency about bulk surveillance, announced Wednesday that the Internet giant will send a representative to a Senate hearing they will hold on 13 November.")),
    article2 = vocabulary.addArticle(Article("Google has expressed outrage following a report that the US National Security Agency (NSA) has hacked its data links. An executive at Google said it was not aware of the alleged activity, adding there was an \"urgent need for reform\". The comments follow a Washington Post report based on leaks from Edward Snowden claiming that the NSA hacked links connecting data centres operated by Google and Yahoo. The NSA's director said it had not had access to the companies' computers. Gen Keith Alexander told Bloomberg TV: \"We are not authorised to go into a US company's servers and take data.\" But correspondents say this is not a direct denial of the latest claims. The revelations stem from documents leaked by ex-US intelligence contractor Edward Snowden, who has been granted temporary asylum in Russia and is wanted in the US in connection with the unauthorised disclosures. The documents say millions of records were gleaned daily from the internet giants' internal networks. They suggest that the NSA intercepted the data at some point as it flowed through fibre-optic cables and other network equipment connecting the companies' data centres, rather than targeting the servers themselves. The data was intercepted outside the US, the documents imply. The data the agency obtained, which ranged from \"metadata' to text, audio and video, were then sifted by an NSA programme called Muscular, operated with the NSA's British counterpart, GCHQ, the documents say. The NSA already has \"front-door\" access to Google and Yahoo user accounts through a court-approved programme known as Prism. Google's chief legal officer David Drummond said Google did not provide any government with access to its systems. \"We have long been concerned about the possibility of this kind of snooping, which is why we have continued to extend encryption across more and more Google services and links, especially the links in the slide,\" Drummond said in a statement. \"We are outraged at the lengths to which the government seems to have gone to intercept data from our private fibre networks, and it underscores the need for urgent reform.\" A spokesperson for Yahoo said the company had \"strict controls in place to protect the security of our data centres, and we have not given access to our data centres to the NSA or to any other government agency\". An NSA spokesperson denied a suggestion in the Washington Post article that the agency gathered \"vast quantities of US persons' data from this type of collection\". NSA Director Gen Keith Alexander: \"We do not have access to Google servers, Yahoo servers\" The latest revelations came hours after a German delegation of intelligence officials arrived in Washington for talks at the White House following claims that the US monitored Chancellor Angela Merkel's mobile phone. Two of Mrs Merkel's most important advisers, foreign policy adviser Christoph Heusgen, and intelligence coordinator Guenter Heiss were sent to take part in the talks - seen as a measure of how seriously Mrs Merkel takes the matter. Next week, the heads of Germany's spying agencies will meet their opposite numbers in Washington. The head of US intelligence has defended the monitoring of foreign leaders as a key goal of operations but the US is facing growing anger over reports it spied on its allies abroad. It has also been reported that the NSA monitored French diplomats in Washington and at the UN, and that it conducted surveillance on millions of French and Spanish telephone calls, among other operations against US allies. Spanish Prime Minister Mariano Rajoy said that if Spain had been a target of the NSA, this would be \"inappropriate and unacceptable between partners\". James Clapper said knowing what foreign leaders were thinking was critical to US policymaking However, Gen Alexander has said \"the assertions... that NSA collected tens of millions of phone calls [in Europe] are completely false\". On Wednesday, the agency denied Italian media reports that it had targeted communications at the Vatican. The UN said it had received assurances that its communications \"are not and will not be monitored\" by American intelligence agencies, but refused to clarify whether they had been in the past. On Tuesday, Director of National Intelligence James Clapper testified before the intelligence panel of the House of Representatives that much of the data cited by non-US news outlets was actually collected by European intelligence services and later shared with the NSA. He said foreign allies spied on US officials and intelligence agencies as a matter of routine.")),
    article3 = vocabulary.addArticle(Article("Internet forums and chatrooms can have positive effects that should be more widely acknowledged, experts say. The call comes after Oxford University researchers carried out an analysis of 14 different studies looking at how young people use the internet. The review - published in the Plos One journal - said a number of studies had found a link between internet use and self-harm and suicide. But it said others had found the internet could be a positive influence. The dangers of internet use have received widespread coverage this year. In one case, in August, 14-year-old Hannah Smith from Leicestershire was found hanged after she had been sent abusive messages on a social networking site. Since then research by the NSPCC has suggested a fifth of 11 to 16-year-olds have had negative experiences using the internet. The Oxford University research highlighted a number of dangers from internet use, including the normalising of self-harm and the risk of bullying. It also said there was a \"strong link\" between internet forums and an increased risk of suicide in particular. Rather than concentrating primarily on ways of blocking and censoring such sites, we should think about online opportunities to reach out to people in emotional distress” But the researchers said some studies had shown that internet forums could support and connect socially isolated people. There were also examples where forum users encouraged positive behaviour, advised others to seek help and congratulated each other for not harming themselves. Report author Prof Keith Hawton said: \"Communication via the internet and other electronic means has potential roles in both contributing to and preventing suicidal behaviour in young people. \"The next step is going to be development of therapeutic interventions using these channels of communication, especially to access those who do not seek help from clinical services.\" Joe Ferns of the Samaritans added: \"We should acknowledge that many people are using suicide forums and chatrooms to anonymously discuss their feelings of distress and despair, including suicidal thoughts, which may have a positive impact on the individual. They may be expressing feelings that they have never disclosed to anyone in their offline lives. \"Rather than concentrating primarily on ways of blocking and censoring such sites, we should think about online opportunities to reach out to people in emotional distress.\"")),
    article4 = vocabulary.addArticle(Article("A group of tech giants known as the Rockstar Consortium is suing Google, Samsung, HTC and others over alleged mobile phone patent infringements. Rockstar, jointly owned by Apple, Microsoft, Blackberry, Ericsson and Sony, is targeting manufacturers of phones that run the rival Google Android operating system. Rockstar spent $4.5bn (£2.8bn) buying thousands of Nortel patents after the telecoms giant went bankrupt in 2009. Google lost out in the bidding war. The Rockstar lawsuit claims Google has infringed seven patents relating to the way internet search terms match up with relevant advertising. Dominance The move is just the latest in a number of mobile device patent cases being fought across the world, as technology behemoths fight for dominance of the lucrative smartphone, tablet and games console markets. Google's Android has been doing particularly well, largely thanks to the success of Samsung's Galaxy range of smartphones. Android devices accounted for 81.3% of smartphone shipments in the third quarter of 2013, according to research firm Strategy Analytics, compared with 13.4% for Apple iOS and 4.1% for Windows Phone. This week, Nokia, whose mobile devices division is being bought by Microsoft, won a patent victory over HTC that could see the Taiwanese company's HTC One smartphone being banned from import into the UK. And earlier in October, Samsung offered to stop taking rivals to court over alleged patent infringements for a period of five years, after European Union authorities said the South Korean company's litigious actions were stifling competition. Samsung faced a potential £11.3bn ($18.3bn) fine if found guilty of breaching European anti-trust laws. Google's Motorola Mobility, which the search giant bought for $12.5bn, has also been accused of similar anti-competitive behaviour. Samsung and Apple are currently slugging it out in the courts of more than 10 countries across Europe. Cross-licensing But some senior technology experts believes the legal conflict is bad for consumers. In an interview with the BBC's Click programme to be broadcast on Saturday, Apple co-founder Steve Wozniak says: There are good things I see on Samsung phones that I wish were in my iPhone; I wish Apple would use them, and could use them, and I don't know if Samsung would stop us. I wish everybody just did a lot of cross-licensing and sharing the good technology; all our products would be better, we'd go further. I do kind of wish they were more compatible. But the Rockstar Consortium's legal action suggests such a rapprochement in the global patent wars is still a long way off."));

/* Running TFIDF on list of articles and setting vectors */
var start = new Date().getTime();
vocabulary.articleList.forEach(function (article) {
  // For every word process the tf-idf
  article.vector = new Array(Object.keys(vocabulary.dictionary).length + 1).join('0').split('').map(parseFloat);
  for (word in article.wordFrequency) {
    if(vocabulary.getWordPosition(word) == undefined)
      console.log(word);
    article.vector[vocabulary.getWordPosition(word)] = TFIDF.run(word, article, vocabulary.articleList);
  }
});
var end = new Date().getTime();
console.log('Process Completed in ' + (end - start) + 'ms');

// console.log(article1.vector);

console.log(TFIDF.findCosineSimilarity(article1.vector, article2.vector));
console.log(TFIDF.findCosineSimilarity(article1.vector, article3.vector));
console.log(TFIDF.findCosineSimilarity(article1.vector, article4.vector));
console.log(TFIDF.findCosineSimilarity(article2.vector, article4.vector));
console.log(TFIDF.findCosineSimilarity(article2.vector, article3.vector));
console.log(TFIDF.findCosineSimilarity(article3.vector, article4.vector));
console.log(TFIDF.findCosineSimilarity(article1.vector, article1.vector));